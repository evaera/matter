<!doctype html>
<html lang="en" dir="ltr" class="plugin-moonwave plugin-id-moonwave">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<title data-rh="true">Loop | matter</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://eryn.io/matter/api/Loop"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Loop | matter"><meta data-rh="true" name="description" content="The Loop class handles scheduling and *looping* (who would have guessed) over all of your game systems.

:::caution Yielding
Yielding is not allowed in systems. Doing so will result in the system thread being closed early, but it will not
affect other systems.
:::"><meta data-rh="true" property="og:description" content="The Loop class handles scheduling and *looping* (who would have guessed) over all of your game systems.

:::caution Yielding
Yielding is not allowed in systems. Doing so will result in the system thread being closed early, but it will not
affect other systems.
:::"><link data-rh="true" rel="canonical" href="https://eryn.io/matter/api/Loop"><link data-rh="true" rel="alternate" href="https://eryn.io/matter/api/Loop" hreflang="en"><link data-rh="true" rel="alternate" href="https://eryn.io/matter/api/Loop" hreflang="x-default"><link rel="stylesheet" href="/matter/assets/css/styles.c025533e.css">
<link rel="preload" href="/matter/assets/js/runtime~main.6c661978.js" as="script">
<link rel="preload" href="/matter/assets/js/main.d3333e4c.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/matter/"><div class="navbar__logo"><img src="/matter/logo.svg" alt="Matter" class="themedImage_ToTc themedImage--light_HNdA"><img src="/matter/logo.svg" alt="Matter" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/matter/docs/intro">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/matter/api/">API</a><a class="navbar__item navbar__link" href="/matter/changelog">Changelog</a></div><div class="navbar__items navbar__items--right"><a href="https://discord.gg/aQwDAYhqtJ" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Roblox Open Source Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://patreon.com/erynlynn" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Support on Patreon<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/evaera/matter" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Press S to Search..." aria-label="Search" class="navbar__search-input search-bar"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docPageContainer_wNNk"><div class="docPage_Dpn1"><div class="docSidebarContainer_o_re"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/matter/api/Matter">​Matter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/matter/api/World">​World</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/matter/api/QueryResult">​Query​Result</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/matter/api/Loop">​Loop</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/matter/api/Component">​Component</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/matter/api/Debugger">​Debugger</a></li></ul></nav></div></div><main class="docMainContainer_HJE1"><div class="container padding-vert--lg"><div class="row"><div class="col docItemCol_MU3C"><div class="docItemContainer_Wv98"><article><div class="member_J0w1 markdown"><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_oUs_"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><header><h1 class="docTitle_mZRt" style="text-decoration:none"><span style="display:inline-block">Loop</span></h1><div class="luaClassTags_EipM"></div><div>
<p>The Loop class handles scheduling and <em>looping</em> (who would have guessed) over all of your game systems.</p>
<div class="admonition admonition-caution alert alert--warning">
  <div class="admonition-heading">
    <h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">
          <path d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path>
        </svg></span>Yielding</h5>
  </div>
  <div class="admonition-content">
    <p>
      Yielding is not allowed in systems. Doing so will result in the system thread being closed early, but it will not
      affect other systems.
    </p>
  </div>
</div>
</div></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="types">Types<a class="hash-link" href="#types" title="Direct link to heading">​</a></h2><div class="divider_rE5g"></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="System"><code style="text-decoration:none">System</code><a class="hash-link" href="#System" title="Direct link to heading">​</a></h3><div class="repositoryDetailsContainer_BPdw"><a class="sourceButton_sEho" href="https://github.com/evaera/matter/blob/main/lib/Loop.lua#L79"><div class="sourceButtonText_Vh0m">&lt;/&gt;</div></a></div><div class="memberString_GwaU"><code class="purple_ieR2">type</code> <code>System<!-- --> = </code> <code class="blue_P4bS"><a style="text-decoration:underline;color:inherit" href="/matter/api/Loop#SystemTable">SystemTable</a></code><code class="op_lSLc"> | </code><code class="purple_ieR2">(</code><code class="blue_P4bS">...any</code><code class="purple_ieR2">)</code><code class="purple_ieR2"> → </code><code class="purple_ieR2">(</code><code class="purple_ieR2">)</code></div><div>
<p>Either a plain function or a table defining the system.</p>
</div><div class="divider_rE5g"></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="SystemTable"><code style="text-decoration:none">SystemTable</code><a class="hash-link" href="#SystemTable" title="Direct link to heading">​</a></h3><div class="repositoryDetailsContainer_BPdw"><a class="sourceButton_sEho" href="https://github.com/evaera/matter/blob/main/lib/Loop.lua#L93"><div class="sourceButtonText_Vh0m">&lt;/&gt;</div></a></div><div class="memberString_GwaU"><code class="purple_ieR2">interface</code> <code>SystemTable<!-- --> <!-- -->{</code><div class="inset_uKQm"><div><code>system<!-- -->: </code><code class="purple_ieR2">(</code><code class="blue_P4bS">...any</code><code class="purple_ieR2">)</code><code class="purple_ieR2"> → </code><code class="purple_ieR2">(</code><code class="purple_ieR2">)</code><span class="inlineDescription_G7Er">-- <span>
<p>The system function</p>
</span></span></div><div><code>event?<!-- -->: </code><code class="blue_P4bS">string</code><span class="inlineDescription_G7Er">-- <span>
<p>The event the system runs on. A string, a key from the table you pass to <code>Loop:begin</code>.</p>
</span></span></div><div><code>priority?<!-- -->: </code><code class="blue_P4bS">number</code><span class="inlineDescription_G7Er">-- <span>
<p>Priority influences the position in the frame the system is scheduled to run at.</p>
</span></span></div><div><code>after?<!-- -->: </code><code class="purple_ieR2">{</code><code class="blue_P4bS"><a style="text-decoration:underline;color:inherit" href="/matter/api/Loop#System">System</a></code><code class="purple_ieR2">}</code><span class="inlineDescription_G7Er">-- <span>
<p>A list of systems that this system must run after.</p>
</span></span></div></div><code>}</code></div><div>
<p>A table defining a system with possible options.</p>
<p>
  Systems are scheduled in order of <code>priority</code>, meaning lower <code>priority</code> runs first.
  The default priority is <code>0</code>.
</p>
</div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="functions">Functions<a class="hash-link" href="#functions" title="Direct link to heading">​</a></h2><div class="divider_rE5g"></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="new"><code style="text-decoration:none">new</code><a class="hash-link" href="#new" title="Direct link to heading">​</a></h3><div class="repositoryDetailsContainer_BPdw"><a class="sourceButton_sEho" href="https://github.com/evaera/matter/blob/main/lib/Loop.lua#L57"><div class="sourceButtonText_Vh0m">&lt;/&gt;</div></a></div><div class="memberString_GwaU"><code>Loop<!-- -->.</code><code class="green_DgR4">new</code><code>(</code><div class="inset_uKQm"><div><code>...<!-- -->: </code><code class="blue_P4bS">...any</code><span class="inlineDescription_G7Er">-- <span>
<p>Values that will be passed to all of your systems</p>
</span></span></div></div><code>) → </code><code class="blue_P4bS"><a style="text-decoration:underline;color:inherit" href="/matter/api/Loop">Loop</a></code></div><div>
<p>Creates a new loop. <code>Loop.new</code> accepts as arguments the values that will be passed to all of your systems.</p>
<p>So typically, you want to pass the World in here, as well as maybe a table of global game state.</p>
<pre class="language-lua"><code class="language-lua"><span class="token keyword">local</span> world <span class="token operator">=</span> World<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">local</span> gameState <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">local</span> loop <span class="token operator">=</span> Loop<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span>world<span class="token punctuation">,</span> gameState<span class="token punctuation">)</span>
</code></pre>
</div><div class="divider_rE5g"></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="scheduleSystems"><code style="text-decoration:none">scheduleSystems</code><a class="hash-link" href="#scheduleSystems" title="Direct link to heading">​</a></h3><div class="repositoryDetailsContainer_BPdw"><a class="sourceButton_sEho" href="https://github.com/evaera/matter/blob/main/lib/Loop.lua#L133"><div class="sourceButtonText_Vh0m">&lt;/&gt;</div></a></div><div class="memberString_GwaU"><code>Loop<!-- -->:</code><code class="green_DgR4">scheduleSystems</code><code>(</code><div class="inset_uKQm"><div><code>systems<!-- -->: </code><code class="purple_ieR2">{</code><code class="blue_P4bS"><a style="text-decoration:underline;color:inherit" href="/matter/api/Loop#System">System</a></code><code class="purple_ieR2">}</code><span class="inlineDescription_G7Er">-- <span>
<p>Array of systems to schedule.</p>
</span></span></div></div><code>) → </code><code>(</code><code>)</code></div><div>
<p>Schedules a set of systems based on the constraints they define.</p>
<p>Systems may optionally declare:</p>
<ul>
  <li>The name of the event they run on (e.g., RenderStepped, Stepped, Heartbeat)</li>
  <li>A numerical priority value</li>
  <li>Other systems that they must run <em>after</em></li>
</ul>
<p>If systems do not specify an event, they will run on the <code>default</code> event.</p>
<p>
  Systems that share an event will run in order of their priority, which means that systems with a lower <code>priority</code>
  value run first. The default priority is <code>0</code>.
</p>
<p>
  Systems that have defined what systems they run <code>after</code> can only be scheduled after all systems they depend on have
  already been scheduled.
</p>
<p>
  All else being equal, the order in which systems run is stable, meaning if you don't change your code, your systems
  will always run in the same order across machines.
</p>
<div class="admonition admonition-info alert alert--info">
  <div class="admonition-heading">
    <h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16">
          <path d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path>
        </svg></span>info</h5>
  </div>
  <div class="admonition-content">
    <p>
      It is possible for your systems to be in an unresolvable state. In which case, <code>scheduleSystems</code> will error.
      This can happen when your systems have circular or unresolvable dependency chains.
    </p>
    <p>
      If a system has both a <code>priority</code> and defines systems it runs <code>after</code>, the system can only be scheduled if all of
      the systems it depends on have a lower or equal priority.
    </p>
    <p>
      Systems can never depend on systems that run on other events, because it is not guaranteed or required that events
      will fire every frame or will always fire in the same order.
    </p>
  </div>
</div>
<div class="admonition admonition-caution alert alert--warning">
  <div class="admonition-heading">
    <h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">
          <path d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path>
        </svg></span>caution</h5>
  </div>
  <div class="admonition-content">
    <p>
      <code>scheduleSystems</code> has to perform nontrivial sorting work each time it's called, so you should avoid calling it multiple
      times if possible.
    </p>
  </div>
</div>
</div><div class="divider_rE5g"></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="scheduleSystem"><code style="text-decoration:none">scheduleSystem</code><a class="hash-link" href="#scheduleSystem" title="Direct link to heading">​</a></h3><div class="repositoryDetailsContainer_BPdw"><a class="sourceButton_sEho" href="https://github.com/evaera/matter/blob/main/lib/Loop.lua#L153"><div class="sourceButtonText_Vh0m">&lt;/&gt;</div></a></div><div class="memberString_GwaU"><code>Loop<!-- -->:</code><code class="green_DgR4">scheduleSystem</code><code>(</code><code>system<!-- -->: </code><code class="blue_P4bS"><a style="text-decoration:underline;color:inherit" href="/matter/api/Loop#System">System</a></code><code>) → </code><code>(</code><code>)</code></div><div>
<p>
  Schedules a single system. This is an expensive function to call multiple times. Instead, try batch scheduling
  systems with <a href="/matter/api/Loop#scheduleSystems">Loop:scheduleSystems</a> if possible.
</p>
</div><div class="divider_rE5g"></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="evictSystem"><code style="text-decoration:none">evictSystem</code><a class="hash-link" href="#evictSystem" title="Direct link to heading">​</a></h3><div class="repositoryDetailsContainer_BPdw"><a class="sourceButton_sEho" href="https://github.com/evaera/matter/blob/main/lib/Loop.lua#L164"><div class="sourceButtonText_Vh0m">&lt;/&gt;</div></a></div><div class="memberString_GwaU"><code>Loop<!-- -->:</code><code class="green_DgR4">evictSystem</code><code>(</code><code>system<!-- -->: </code><code class="blue_P4bS"><a style="text-decoration:underline;color:inherit" href="/matter/api/Loop#System">System</a></code><code>) → </code><code>(</code><code>)</code></div><div>
<p>
  Removes a previously-scheduled system from the Loop. Evicting a system also cleans up any storage from hooks.
  This is intended to be used for hot reloading. Dynamically loading and unloading systems for gameplay logic
  is not recommended.
</p>
</div><div class="divider_rE5g"></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="replaceSystem"><code style="text-decoration:none">replaceSystem</code><a class="hash-link" href="#replaceSystem" title="Direct link to heading">​</a></h3><div class="repositoryDetailsContainer_BPdw"><a class="sourceButton_sEho" href="https://github.com/evaera/matter/blob/main/lib/Loop.lua#L189"><div class="sourceButtonText_Vh0m">&lt;/&gt;</div></a></div><div class="memberString_GwaU"><code>Loop<!-- -->:</code><code class="green_DgR4">replaceSystem</code><code>(</code><div class="inset_uKQm"><div><code>old<!-- -->: </code><code class="blue_P4bS"><a style="text-decoration:underline;color:inherit" href="/matter/api/Loop#System">System</a></code><code>,</code></div><div><code>new<!-- -->: </code><code class="blue_P4bS"><a style="text-decoration:underline;color:inherit" href="/matter/api/Loop#System">System</a></code></div></div><code>) → </code><code>(</code><code>)</code></div><div>
<p>
  Replaces an older version of a system with a newer version of the system. Internal system storage (which is used
  by hooks) will be moved to be associated with the new system. This is intended to be used for hot reloading.
</p>
</div><div class="divider_rE5g"></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="begin"><code style="text-decoration:none">begin</code><a class="hash-link" href="#begin" title="Direct link to heading">​</a></h3><div class="repositoryDetailsContainer_BPdw"><a class="sourceButton_sEho" href="https://github.com/evaera/matter/blob/main/lib/Loop.lua#L332"><div class="sourceButtonText_Vh0m">&lt;/&gt;</div></a></div><div class="memberString_GwaU"><code>Loop<!-- -->:</code><code class="green_DgR4">begin</code><code>(</code><div class="inset_uKQm"><div><code>events<!-- -->: </code><code class="purple_ieR2">{</code><span><code>[</code><code class="blue_P4bS">string</code><code>]</code></span><code>: </code><code class="blue_P4bS"><a style="text-decoration:underline;color:inherit" href="https://developer.roblox.com/en-us/api-reference/datatype/RBXScriptSignal" target="_blank" rel="noopener noreferrer">RBXScriptSignal<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound" style="color:gray;vertical-align:middle;margin-left:2px"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></code><code class="purple_ieR2">}</code><span class="inlineDescription_G7Er">-- <span>
<p>A map from event name to event objects.</p>
</span></span></div></div><code>) → </code><code class="purple_ieR2">{</code><span><code>[</code><code class="blue_P4bS">string</code><code>]</code></span><code>: </code><code class="blue_P4bS"><a style="text-decoration:underline;color:inherit" href="https://developer.roblox.com/en-us/api-reference/datatype/RBXScriptConnection" target="_blank" rel="noopener noreferrer">RBXScriptConnection<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound" style="color:gray;vertical-align:middle;margin-left:2px"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></code><code class="purple_ieR2">}</code><span class="inlineDescription_G7Er">-- <span>
<p>A map from your event names to connection objects.</p>
</span></span></div><div>
<p>Connects to frame events and starts invoking your systems.</p>
<p>
  Pass a table of events you want to be able to run systems on, a map of name to event. Systems can use these names
  to define what event they run on. By default, systems run on an event named <code>"default"</code>. Custom events may be used
  if they have a <code>Connect</code> function.
</p>
<pre class="language-lua"><code class="language-lua">loop<span class="token punctuation">:</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	default <span class="token operator">=</span> RunService<span class="token punctuation">.</span>Heartbeat<span class="token punctuation">,</span>
	Heartbeat <span class="token operator">=</span> RunService<span class="token punctuation">.</span>Heartbeat<span class="token punctuation">,</span>
	RenderStepped <span class="token operator">=</span> RunService<span class="token punctuation">.</span>RenderStepped<span class="token punctuation">,</span>
	Stepped <span class="token operator">=</span> RunService<span class="token punctuation">.</span>Stepped<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p> </p>
<p>
  Returns a table similar to the one you passed in, but the values are <code>RBXScriptConnection</code> values (or whatever is
  returned by <code>:Connect</code> if you passed in a synthetic event).
</p>
</div><div class="divider_rE5g"></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="addMiddleware"><code style="text-decoration:none">addMiddleware</code><a class="hash-link" href="#addMiddleware" title="Direct link to heading">​</a></h3><div class="repositoryDetailsContainer_BPdw"><a class="sourceButton_sEho" href="https://github.com/evaera/matter/blob/main/lib/Loop.lua#L496"><div class="sourceButtonText_Vh0m">&lt;/&gt;</div></a></div><div class="memberString_GwaU"><code>Loop<!-- -->:</code><code class="green_DgR4">addMiddleware</code><code>(</code><code>middleware<!-- -->: </code><code class="purple_ieR2">(</code><div class="inset_uKQm"><code>nextFn<!-- -->: </code><code class="green_DgR4">(</code><code class="green_DgR4">)</code><code class="green_DgR4"> → </code><code class="green_DgR4">(</code><code class="green_DgR4">)</code><code class="purple_ieR2">,</code></div><div class="inset_uKQm"><code>eventName<!-- -->: </code><code class="blue_P4bS">string</code></div><code class="purple_ieR2">)</code><code class="purple_ieR2"> → </code><code class="purple_ieR2">(</code><code class="purple_ieR2">)</code><code class="purple_ieR2"> → </code><code class="purple_ieR2">(</code><code class="purple_ieR2">)</code><code>) → </code><code>(</code><code>)</code></div><div>
<p>Adds a user-defined middleware function that is called during each frame.</p>
<p>This allows you to run code before and after each frame, to perform initialization and cleanup work.</p>
<pre class="language-lua"><code class="language-lua">loop<span class="token punctuation">:</span><span class="token function">addMiddleware</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>nextFn<span class="token punctuation">)</span>
	<span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		Plasma<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span>plasmaNode<span class="token punctuation">,</span> nextFn<span class="token punctuation">)</span>
	<span class="token keyword">end</span>
<span class="token keyword">end</span><span class="token punctuation">)</span>
</code></pre>
<p>You must pass <code>addMiddleware</code> a function that itself returns a function that invokes <code>nextFn</code> at some point.</p>
<p>The outer function is invoked only once. The inner function is invoked during each frame event.</p>
<div class="admonition admonition-info alert alert--info">
  <div class="admonition-heading">
    <h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16">
          <path d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path>
        </svg></span>info</h5>
  </div>
  <div class="admonition-content">
    <p>
      Middleware added later "wraps" middleware that was added earlier. The innermost middleware function is the internal
      function that actually calls your systems.
    </p>
  </div>
</div>
</div></div></article></div><details><summary>Show raw api</summary><pre style="max-width:100%;white-space:pre-wrap">{
    &quot;functions&quot;: [
        {
            &quot;name&quot;: &quot;new&quot;,
            &quot;desc&quot;: &quot;Creates a new loop. `Loop.new` accepts as arguments the values that will be passed to all of your systems.\n\nSo typically, you want to pass the World in here, as well as maybe a table of global game state.\n\n```lua\nlocal world = World.new()\nlocal gameState = {}\n\nlocal loop = Loop.new(world, gameState)\n```&quot;,
            &quot;params&quot;: [
                {
                    &quot;name&quot;: &quot;...&quot;,
                    &quot;desc&quot;: &quot;Values that will be passed to all of your systems&quot;,
                    &quot;lua_type&quot;: &quot;...any&quot;
                }
            ],
            &quot;returns&quot;: [
                {
                    &quot;desc&quot;: &quot;&quot;,
                    &quot;lua_type&quot;: &quot;Loop&quot;
                }
            ],
            &quot;function_type&quot;: &quot;static&quot;,
            &quot;source&quot;: {
                &quot;line&quot;: 57,
                &quot;path&quot;: &quot;lib/Loop.lua&quot;
            }
        },
        {
            &quot;name&quot;: &quot;scheduleSystems&quot;,
            &quot;desc&quot;: &quot;Schedules a set of systems based on the constraints they define.\n\nSystems may optionally declare:\n- The name of the event they run on (e.g., RenderStepped, Stepped, Heartbeat)\n- A numerical priority value\n- Other systems that they must run *after*\n\nIf systems do not specify an event, they will run on the `default` event.\n\nSystems that share an event will run in order of their priority, which means that systems with a lower `priority`\nvalue run first. The default priority is `0`.\n\nSystems that have defined what systems they run `after` can only be scheduled after all systems they depend on have\nalready been scheduled.\n\nAll else being equal, the order in which systems run is stable, meaning if you don&#x27;t change your code, your systems\nwill always run in the same order across machines.\n\n:::info\nIt is possible for your systems to be in an unresolvable state. In which case, `scheduleSystems` will error.\nThis can happen when your systems have circular or unresolvable dependency chains.\n\nIf a system has both a `priority` and defines systems it runs `after`, the system can only be scheduled if all of\nthe systems it depends on have a lower or equal priority.\n\nSystems can never depend on systems that run on other events, because it is not guaranteed or required that events\nwill fire every frame or will always fire in the same order.\n:::\n\n:::caution\n`scheduleSystems` has to perform nontrivial sorting work each time it&#x27;s called, so you should avoid calling it multiple\ntimes if possible.\n:::&quot;,
            &quot;params&quot;: [
                {
                    &quot;name&quot;: &quot;systems&quot;,
                    &quot;desc&quot;: &quot;Array of systems to schedule.&quot;,
                    &quot;lua_type&quot;: &quot;{ System }&quot;
                }
            ],
            &quot;returns&quot;: [],
            &quot;function_type&quot;: &quot;method&quot;,
            &quot;source&quot;: {
                &quot;line&quot;: 133,
                &quot;path&quot;: &quot;lib/Loop.lua&quot;
            }
        },
        {
            &quot;name&quot;: &quot;scheduleSystem&quot;,
            &quot;desc&quot;: &quot;Schedules a single system. This is an expensive function to call multiple times. Instead, try batch scheduling\nsystems with [Loop:scheduleSystems] if possible.&quot;,
            &quot;params&quot;: [
                {
                    &quot;name&quot;: &quot;system&quot;,
                    &quot;desc&quot;: &quot;&quot;,
                    &quot;lua_type&quot;: &quot;System&quot;
                }
            ],
            &quot;returns&quot;: [],
            &quot;function_type&quot;: &quot;method&quot;,
            &quot;source&quot;: {
                &quot;line&quot;: 153,
                &quot;path&quot;: &quot;lib/Loop.lua&quot;
            }
        },
        {
            &quot;name&quot;: &quot;evictSystem&quot;,
            &quot;desc&quot;: &quot;Removes a previously-scheduled system from the Loop. Evicting a system also cleans up any storage from hooks.\nThis is intended to be used for hot reloading. Dynamically loading and unloading systems for gameplay logic\nis not recommended.&quot;,
            &quot;params&quot;: [
                {
                    &quot;name&quot;: &quot;system&quot;,
                    &quot;desc&quot;: &quot;&quot;,
                    &quot;lua_type&quot;: &quot;System&quot;
                }
            ],
            &quot;returns&quot;: [],
            &quot;function_type&quot;: &quot;method&quot;,
            &quot;source&quot;: {
                &quot;line&quot;: 164,
                &quot;path&quot;: &quot;lib/Loop.lua&quot;
            }
        },
        {
            &quot;name&quot;: &quot;replaceSystem&quot;,
            &quot;desc&quot;: &quot;Replaces an older version of a system with a newer version of the system. Internal system storage (which is used\nby hooks) will be moved to be associated with the new system. This is intended to be used for hot reloading.&quot;,
            &quot;params&quot;: [
                {
                    &quot;name&quot;: &quot;old&quot;,
                    &quot;desc&quot;: &quot;&quot;,
                    &quot;lua_type&quot;: &quot;System&quot;
                },
                {
                    &quot;name&quot;: &quot;new&quot;,
                    &quot;desc&quot;: &quot;&quot;,
                    &quot;lua_type&quot;: &quot;System&quot;
                }
            ],
            &quot;returns&quot;: [],
            &quot;function_type&quot;: &quot;method&quot;,
            &quot;source&quot;: {
                &quot;line&quot;: 189,
                &quot;path&quot;: &quot;lib/Loop.lua&quot;
            }
        },
        {
            &quot;name&quot;: &quot;begin&quot;,
            &quot;desc&quot;: &quot;Connects to frame events and starts invoking your systems.\n\nPass a table of events you want to be able to run systems on, a map of name to event. Systems can use these names\nto define what event they run on. By default, systems run on an event named `\&quot;default\&quot;`. Custom events may be used\nif they have a `Connect` function.\n\n```lua\nloop:begin({\n\tdefault = RunService.Heartbeat,\n\tHeartbeat = RunService.Heartbeat,\n\tRenderStepped = RunService.RenderStepped,\n\tStepped = RunService.Stepped,\n})\n```\n\n&amp;nbsp;\n\nReturns a table similar to the one you passed in, but the values are `RBXScriptConnection` values (or whatever is\nreturned by `:Connect` if you passed in a synthetic event).&quot;,
            &quot;params&quot;: [
                {
                    &quot;name&quot;: &quot;events&quot;,
                    &quot;desc&quot;: &quot;A map from event name to event objects.&quot;,
                    &quot;lua_type&quot;: &quot;{[string]: RBXScriptSignal}&quot;
                }
            ],
            &quot;returns&quot;: [
                {
                    &quot;desc&quot;: &quot;A map from your event names to connection objects.&quot;,
                    &quot;lua_type&quot;: &quot;{[string]: RBXScriptConnection}&quot;
                }
            ],
            &quot;function_type&quot;: &quot;method&quot;,
            &quot;source&quot;: {
                &quot;line&quot;: 332,
                &quot;path&quot;: &quot;lib/Loop.lua&quot;
            }
        },
        {
            &quot;name&quot;: &quot;addMiddleware&quot;,
            &quot;desc&quot;: &quot;Adds a user-defined middleware function that is called during each frame.\n\nThis allows you to run code before and after each frame, to perform initialization and cleanup work.\n\n```lua\nloop:addMiddleware(function(nextFn)\n\treturn function()\n\t\tPlasma.start(plasmaNode, nextFn)\n\tend\nend)\n```\n\nYou must pass `addMiddleware` a function that itself returns a function that invokes `nextFn` at some point.\n\nThe outer function is invoked only once. The inner function is invoked during each frame event.\n\n:::info\nMiddleware added later \&quot;wraps\&quot; middleware that was added earlier. The innermost middleware function is the internal\nfunction that actually calls your systems.\n:::&quot;,
            &quot;params&quot;: [
                {
                    &quot;name&quot;: &quot;middleware&quot;,
                    &quot;desc&quot;: &quot;&quot;,
                    &quot;lua_type&quot;: &quot;(nextFn: () -&gt; (), eventName: string) -&gt; () -&gt; ()&quot;
                }
            ],
            &quot;returns&quot;: [],
            &quot;function_type&quot;: &quot;method&quot;,
            &quot;source&quot;: {
                &quot;line&quot;: 496,
                &quot;path&quot;: &quot;lib/Loop.lua&quot;
            }
        }
    ],
    &quot;properties&quot;: [],
    &quot;types&quot;: [
        {
            &quot;name&quot;: &quot;System&quot;,
            &quot;desc&quot;: &quot;Either a plain function or a table defining the system.&quot;,
            &quot;lua_type&quot;: &quot;SystemTable | (...any) -&gt; ()&quot;,
            &quot;source&quot;: {
                &quot;line&quot;: 79,
                &quot;path&quot;: &quot;lib/Loop.lua&quot;
            }
        },
        {
            &quot;name&quot;: &quot;SystemTable&quot;,
            &quot;desc&quot;: &quot;A table defining a system with possible options.\n\nSystems are scheduled in order of `priority`, meaning lower `priority` runs first.\nThe default priority is `0`.&quot;,
            &quot;fields&quot;: [
                {
                    &quot;name&quot;: &quot;system&quot;,
                    &quot;lua_type&quot;: &quot;(...any) -&gt; ()&quot;,
                    &quot;desc&quot;: &quot;The system function&quot;
                },
                {
                    &quot;name&quot;: &quot;event?&quot;,
                    &quot;lua_type&quot;: &quot;string&quot;,
                    &quot;desc&quot;: &quot;The event the system runs on. A string, a key from the table you pass to `Loop:begin`.&quot;
                },
                {
                    &quot;name&quot;: &quot;priority?&quot;,
                    &quot;lua_type&quot;: &quot;number&quot;,
                    &quot;desc&quot;: &quot;Priority influences the position in the frame the system is scheduled to run at.&quot;
                },
                {
                    &quot;name&quot;: &quot;after?&quot;,
                    &quot;lua_type&quot;: &quot;{System}&quot;,
                    &quot;desc&quot;: &quot;A list of systems that this system must run after.&quot;
                }
            ],
            &quot;source&quot;: {
                &quot;line&quot;: 93,
                &quot;path&quot;: &quot;lib/Loop.lua&quot;
            }
        }
    ],
    &quot;name&quot;: &quot;Loop&quot;,
    &quot;desc&quot;: &quot;The Loop class handles scheduling and *looping* (who would have guessed) over all of your game systems.\n\n:::caution Yielding\nYielding is not allowed in systems. Doing so will result in the system thread being closed early, but it will not\naffect other systems.\n:::&quot;,
    &quot;source&quot;: {
        &quot;line&quot;: 39,
        &quot;path&quot;: &quot;lib/Loop.lua&quot;
    }
}</pre></details></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#types" class="table-of-contents__link toc-highlight">Types</a><ul><li><a href="#System" class="table-of-contents__link toc-highlight">System</a></li><li><a href="#SystemTable" class="table-of-contents__link toc-highlight">SystemTable</a></li></ul></li><li><a href="#properties" class="table-of-contents__link toc-highlight">Properties</a></li><li><a href="#functions" class="table-of-contents__link toc-highlight">Functions</a><ul><li><a href="#addMiddleware" class="table-of-contents__link toc-highlight">:addMiddleware</a></li><li><a href="#begin" class="table-of-contents__link toc-highlight">:begin</a></li><li><a href="#evictSystem" class="table-of-contents__link toc-highlight">:evictSystem</a></li><li><a href="#replaceSystem" class="table-of-contents__link toc-highlight">:replaceSystem</a></li><li><a href="#scheduleSystem" class="table-of-contents__link toc-highlight">:scheduleSystem</a></li><li><a href="#scheduleSystems" class="table-of-contents__link toc-highlight">:scheduleSystems</a></li><li><a href="#new" class="table-of-contents__link toc-highlight">.new</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 evaera. Built with Moonwave and Docusaurus.</div></div></div></footer></div>
<script src="/matter/assets/js/runtime~main.6c661978.js"></script>
<script src="/matter/assets/js/main.d3333e4c.js"></script>
</body>
</html>